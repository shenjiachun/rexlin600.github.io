---
layout: post
title: "1. Springæ¦‚è¿°"
date: 1997-07-01
categories: Spring
tags: Spring
excerpt: SpringåŸºç¡€æ¦‚è¿°
mathjax: true
---

## Spring æ¦‚è¿°

Spring çš„ç›¸å…³å†å²è¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œæ¨èå¤§å®¶å¯ä»¥çœ‹ä¸‹`readme.md`ä¸­æåˆ°çš„ ğŸ“šã€‚è¿™é‡Œä¸»è¦å¹ä¸€æ³¢ Spring æ¡†æ¶çš„å¥½å¤„ã€‚

### Spring çš„ä¼˜ç‚¹

1. æ–¹ä¾¿è§£è€¦ã€ç®€åŒ–å¼€å‘ï¼ˆåŒ…æ‹¬å®ä¾‹çš„æ§åˆ¶ã€è¯¸å¤š Java EE API ä½¿ç”¨çš„å°è£…ç­‰ï¼‰
2. AOP ç¼–ç¨‹æ”¯æŒ
3. å£°æ˜å¼äº‹åŠ¡æ”¯æŒ
4. æ–¹ä¾¿ç¨‹åºæµ‹è¯•
5. æ–¹ä¾¿é›†æˆå…¶ä»–ä¼˜ç§€æ¡†æ¶
6. æºç è®¾è®¡ä¼˜ç§€ã€å€¼å¾—å­¦ä¹ ã€ç ”ç©¶

### Spring ä½“ç³»ç»“æ„

ä¸‹å›¾æ˜¯ [Spring æ¡†æ¶çš„æ¨¡å—ç»“æ„è®¾è®¡](https://docs.spring.io/spring/docs/4.3.22.RELEASE/spring-framework-reference/htmlsingle/#overview-modules)ï¼š

![spring_01](../../../images/spring/spring_01.jpg)

ä» Spring çš„ä½“ç³»ç»“æ„ä¸Šæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ° Spring çš„æ¨¡å—è®¾è®¡ï¼š

1. `Core Container`ï¼šæ ¸å¿ƒå®¹å™¨ï¼ŒåŒ…æ‹¬ spring-beansã€spring-coreã€spring-contextã€spring-context-support ä»¥åŠ spring-expressionã€‚

   > spring-coreã€spring-beans æä¾›äº†æ¡†æ¶çš„åŸºæœ¬æ”¯æŒï¼ŒåŒ…æ‹¬ AOP å’Œ DI ç­‰ç‰¹å¾ã€‚`BeanFactory`æä¾›äº†å·¥å‚æ¨¡å¼çš„å¤æ‚å®ç°ï¼Œå®ƒæ¶ˆé™¤äº†å¯¹ç¼–ç¨‹å•ä¾‹çš„éœ€æ±‚ï¼Œå¹¶å…è®¸æ‚¨ä»å®é™…çš„ç¨‹åºé€»è¾‘ä¸­åˆ†ç¦»å‡ºä¾èµ–å…³ç³»çš„é…ç½®å’Œè§„èŒƒã€‚
   >
   > spring-context å»ºç«‹åœ¨ coreã€beans æ¨¡å—çš„åŸºç¡€ä¸Šï¼Œæ˜¯ä¸€ä¸ªè®¿é—®æ¡†æ¶å¼çš„æ–¹å¼ã€‚Context æ¨¡å—ä» Beans æ¨¡å—ç»§æ‰¿å…¶åŠŸèƒ½å¹¶æ·»åŠ äº†è¯¸å¦‚ï¼šå›½é™…åŒ–ã€äº‹ä»¶ä¼ æ’­ã€èµ„æºåŠ è½½ä»¥åŠé€šè¿‡ Servlet å®¹å™¨é€æ˜çš„åˆ›å»ºä¸Šä¸‹æ–‡çš„æ”¯æŒã€‚Context æ¨¡å—è¿˜æ”¯æŒ Java EE åŠŸèƒ½ï¼Œä¾‹å¦‚ EJBï¼ŒJMX å’ŒåŸºæœ¬è¿œç¨‹å¤„ç†ã€‚è¯¥ ApplicationContext æ¥å£æ˜¯è¯­å¢ƒæ¨¡å—çš„ç„¦ç‚¹ã€‚ spring-context-support æ”¯æŒå°†å¸¸è§çš„ç¬¬ä¸‰æ–¹åº“é›†æˆåˆ° Spring åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­ï¼Œç”¨äºç¼“å­˜ï¼ˆEhCacheï¼ŒGuavaï¼ŒJCacheï¼‰ï¼Œé‚®ä»¶ï¼ˆJavaMailï¼‰ï¼Œè°ƒåº¦ï¼ˆCommonJï¼ŒQuartzï¼‰å’Œæ¨¡æ¿å¼•æ“ï¼ˆFreeMarkerï¼ŒJasperReportsï¼ŒVelocityï¼‰ã€‚
   >
   > spring-expression æ˜¯ JSP 2.1 è§„èŒƒä¸­æŒ‡å®šçš„ç»Ÿä¸€è¡¨è¾¾å¼è¯­è¨€ï¼ˆç»Ÿä¸€ ELï¼‰çš„æ‰©å±•ã€‚è¯¥è¯­è¨€æ”¯æŒè®¾ç½®å’Œè·å–å±æ€§å€¼ï¼Œå±æ€§èµ‹å€¼ï¼Œæ–¹æ³•è°ƒç”¨ï¼Œè®¿é—®æ•°ç»„ï¼Œé›†åˆå’Œç´¢å¼•å™¨çš„å†…å®¹ï¼Œé€»è¾‘å’Œç®—æœ¯è¿ç®—ç¬¦ï¼Œå‘½åå˜é‡ä»¥åŠä» Spring çš„ IoC å®¹å™¨ä¸­æŒ‰åç§°æ£€ç´¢å¯¹è±¡ã€‚

2. `AOP` ã€`Aspects`ã€`Instumentation`ï¼šé€šä¿—çš„è®²å°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ã€‚AOP æä¾›äº†å¦‚æ–¹æ³•æ‹¦æˆªå™¨ã€åˆ‡å…¥ç‚¹ä»¥ä¾¿æˆ‘ä»¬å¯¹ç¨‹åºåŠŸèƒ½çš„è§£è€¦ã€‚

   > spring-aspects æ¨¡å—æä¾›ä¸ AspectJ çš„é›†æˆ
   >
   > spring-instrument æ¨¡å—æä¾›äº†åœ¨æŸäº›åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸­ä½¿ç”¨çš„ç±»æ£€æµ‹æ”¯æŒå’Œç±»åŠ è½½å™¨å®ç°ã€‚è¯¥ spring-instrument-tomcat æ¨¡å—åŒ…å« Spring çš„ Tomcat æ£€æµ‹ä»£ç†ã€‚

3. `Messging`ï¼šSpring æ¡†æ¶ 4 åŒ…æ‹¬ spring-messaging ä»å…³é”®æŠ½è±¡æ¨¡å— Spring é›†æˆé¡¹ç›®ï¼Œä¾‹å¦‚ Messageï¼ŒMessageChannelï¼ŒMessageHandlerï¼Œå’Œå…¶ä»–äººä½œä¸ºåŸºäºæ¶ˆæ¯çš„åº”ç”¨å¥ å®šäº†åŸºç¡€ã€‚è¯¥æ¨¡å—è¿˜åŒ…æ‹¬ä¸€ç»„ç”¨äºå°†æ¶ˆæ¯æ˜ å°„åˆ°æ–¹æ³•çš„æ³¨é‡Šï¼Œç±»ä¼¼äºåŸºäº Spring MVC æ³¨é‡Šçš„ç¼–ç¨‹æ¨¡å‹ã€‚

4. `Data Access/Integration`ï¼šæ•°æ®è®¿é—®/é›†æˆå±‚ç”± JDBCï¼ŒORMï¼ŒOXMï¼ŒJMS å’Œäº¤æ˜“æ¨¡å—ã€‚

   > spring-JDBC æä¾›äº†å¯¹ jdbc è®¿é—®çš„å°è£…ï¼›
   > spring-tx æ”¯æŒå£°æ˜å¼çš„æ•°æ®åº“è®¿é—®ç¼–ç¨‹å’Œç®¡ç†ï¼›
   > spring-orm ä¸ºå¸‚é¢ä¸Šæµè¡Œçš„å¯¹è±¡å…³ç³»æ˜ å°„ API æä¾›äº†é›†æˆï¼ŒåŒ…æ‹¬ JPAï¼Œ JDO å’Œ Hibernateï¼Œä½¿ç”¨è¯¥ spring-orm æ¨¡å—ï¼Œæ‚¨å¯ä»¥å°†æ‰€æœ‰è¿™äº› O / R æ˜ å°„æ¡†æ¶ä¸ Spring æä¾›çš„æ‰€æœ‰å…¶ä»–åŠŸèƒ½ç»“åˆä½¿ç”¨ï¼Œä¾‹å¦‚å‰é¢æåˆ°çš„ç®€å•å£°æ˜å¼äº‹åŠ¡ç®¡ç†åŠŸèƒ½ï¼›
   > spring-oxm æ¨¡å—æä¾›äº†ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œæ”¯æŒå¯¹è±¡/ XML æ˜ å°„å®ç°ï¼Œå¦‚ JAXBï¼ŒCastorï¼ŒXMLBeansï¼ŒJiBX å’Œ XStreamã€‚
   > æ‰€è¿° spring-jms æ¨¡å—ï¼ˆJava æ¶ˆæ¯æœåŠ¡ï¼‰åŒ…å«ç”¨äºç”Ÿæˆå’Œä½¿ç”¨æ¶ˆæ¯çš„åŠŸèƒ½ã€‚ä» Spring Framework 4.1 å¼€å§‹ï¼Œå®ƒæä¾›äº†ä¸ spring-messaging æ¨¡å—çš„

5. `Web`ï¼šç½‘ç»œå±‚ç”±çš„ spring-webï¼Œspring-webmvcï¼Œspring-websocketï¼Œå’Œ spring-webmvc-portlet æ¨¡å—ã€‚

   > spring-web æä¾›äº†å¯¹ web ç¨‹åºçš„é›†æˆæ”¯æŒï¼Œä¾‹å¦‚å¤šéƒ¨åˆ†æ–‡ä»¶ä¸Šè½½åŠŸèƒ½ä»¥åŠä½¿ç”¨ Servlet ä¾¦å¬å™¨å’Œé¢å‘ Web çš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡åˆå§‹åŒ– IoC å®¹å™¨ã€‚å®ƒè¿˜åŒ…å«ä¸€ä¸ª HTTP å®¢æˆ·ç«¯ä»¥åŠ Spring çš„è¿œç¨‹æ”¯æŒçš„ Web ç›¸å…³éƒ¨åˆ†ã€‚
   > spring-webmvc åŒ…å«ç”¨äº Web åº”ç”¨ç¨‹åºçš„ Spring çš„æ¨¡å‹ - è§†å›¾ - æ§åˆ¶å™¨ï¼ˆMVCï¼‰å’Œ REST Web æœåŠ¡å®ç°ã€‚
   > spring-webmvc-portlet æ¨¡å—ï¼ˆä¹Ÿç§°ä¸º Web-Portlet æ¨¡å—ï¼‰æä¾›äº†åœ¨ Portlet ç¯å¢ƒä¸­ä½¿ç”¨çš„ MVC å®ç°ï¼Œå¹¶é•œåƒäº†åŸºäº Servlet çš„ spring-webmvc æ¨¡å—çš„åŠŸèƒ½ã€‚

6. `Test`ï¼šspring-test æ¨¡å—æ”¯æŒä½¿ç”¨ JUnit æˆ– TestNG å¯¹ Spring ç»„ä»¶è¿›è¡Œå•å…ƒæµ‹è¯•å’Œ é›†æˆæµ‹è¯•ã€‚å®ƒæä¾›äº† Spring çš„ä¸€è‡´åŠ è½½ ApplicationContext å’Œè¿™äº›ä¸Šä¸‹æ–‡çš„ç¼“å­˜ã€‚å®ƒè¿˜æä¾›äº†å¯ç”¨äºç‹¬ç«‹æµ‹è¯•ä»£ç çš„æ¨¡æ‹Ÿå¯¹è±¡ã€‚

### Springçš„ä¸ªåˆ«è§„æ ¼

- Servlet APIï¼ˆJSR 340ï¼‰
- WebSocket APIï¼ˆJSR 356ï¼‰
- å¹¶å‘å®ç”¨ç¨‹åºï¼ˆJSR 236ï¼‰
- JSONç»‘å®šAPIï¼ˆJSR 367ï¼‰
- BeanéªŒè¯ï¼ˆJSR 303ï¼‰
- JPAï¼ˆJSR 338ï¼‰
- JMSï¼ˆJSR 914ï¼‰
- ä¾èµ–æ³¨å…¥ï¼ˆJSR 330ï¼‰
- Common Annotationsï¼ˆJSR 250ï¼‰

ä»Spring Framework 5.0å¼€å§‹ï¼ŒSpringè‡³å°‘éœ€è¦Java EEçº§åˆ«ï¼ˆå¦‚Servlet 3.1ã€JPA2.1+ï¼‰ã€‚ åŒæ—¶åœ¨Java EE 8çº§åˆ«æä¾›ä¸æ–°APIçš„å¼€ç®±å³ç”¨é›†æˆï¼ˆä¾‹å¦‚ï¼ŒServlet 4.0ï¼ŒJSONç»‘å®šAPIï¼‰åœ¨è¿è¡Œæ—¶é‡åˆ°ã€‚è¿™ä½¿Springä¸Tomcat 8å’Œ9ï¼ŒWebSphere 9å’ŒJBoss EAP 7å®Œå…¨å…¼å®¹ã€‚

`Framework 5å¼€å§‹ï¼ŒWebFluxåº”ç”¨ç¨‹åºç”šè‡³ä¸ç›´æ¥ä½¿ç”¨Servlet APIï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸æ˜¯Servletå®¹å™¨çš„æœåŠ¡å™¨ï¼ˆä¾‹å¦‚Nettyï¼‰ä¸Šè¿è¡Œã€‚`

### Springçš„è®¾è®¡åŸåˆ™

- æä¾›å„ä¸ªå±‚é¢çš„é€‰æ‹©ã€‚Springå…è®¸æ‚¨å°½å¯èƒ½æ™šåœ°æ¨è¿Ÿè®¾è®¡å†³ç­–ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥é€šè¿‡é…ç½®åˆ‡æ¢æŒä¹…æ€§æä¾›ç¨‹åºï¼Œè€Œæ— éœ€æ›´æ”¹ä»£ç ã€‚è®¸å¤šå…¶ä»–åŸºç¡€æ¶æ„é—®é¢˜ä»¥åŠä¸ç¬¬ä¸‰æ–¹APIçš„é›†æˆä¹Ÿæ˜¯å¦‚æ­¤ã€‚

- é€‚åº”ä¸åŒçš„è§‚ç‚¹ã€‚Springæ‹¥æŠ±çµæ´»æ€§ï¼Œå¹¶ä¸è®¤ä¸ºåº”è¯¥å¦‚ä½•åšã€‚å®ƒä»¥ä¸åŒçš„è§†è§’æ”¯æŒå¹¿æ³›çš„åº”ç”¨éœ€æ±‚ã€‚

- ä¿æŒå¼ºå¤§çš„å‘åå…¼å®¹æ€§ã€‚Springçš„æ¼”å˜ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œå¯ä»¥åœ¨ç‰ˆæœ¬ä¹‹é—´è¿›è¡Œä¸€äº›é‡å¤§æ”¹å˜ã€‚Springæ”¯æŒç²¾å¿ƒæŒ‘é€‰çš„JDKç‰ˆæœ¬å’Œç¬¬ä¸‰æ–¹åº“ï¼Œä»¥ä¾¿äºç»´æŠ¤ä¾èµ–äºSpringçš„åº”ç”¨ç¨‹åºå’Œåº“ã€‚

- å…³å¿ƒAPIè®¾è®¡ã€‚Springå›¢é˜ŸèŠ±äº†å¾ˆå¤šå¿ƒæ€å’Œæ—¶é—´æ¥åˆ¶ä½œç›´è§‚çš„APIï¼Œè¿™äº›APIåœ¨å¾ˆå¤šç‰ˆæœ¬å’Œå¤šå¹´ä¸­éƒ½æœ‰ç”¨ã€‚

- ä¸ºä»£ç è´¨é‡è®¾å®šé«˜æ ‡å‡†ã€‚Spring Frameworkå¼ºè°ƒæœ‰æ„ä¹‰ï¼Œæœ€æ–°ä¸”å‡†ç¡®çš„Javadocã€‚å®ƒæ˜¯æå°‘æ•°é¡¹ç›®ä¹‹ä¸€ï¼Œå¯ä»¥å£°ç§°å¹²å‡€çš„ä»£ç ç»“æ„ï¼ŒåŒ…ä¹‹é—´æ²¡æœ‰å¾ªç¯ä¾èµ–ã€‚

### é—®é¢˜å’Œåé¦ˆ

è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼š`StackOverflow`

### Spring 4.X

è¿™é‡Œä¸å†å å­—æè¿° Spring4.X æ–°å¢çš„åŠŸèƒ½ä»¥åŠç‰ˆæœ¬çš„ä¾èµ–ã€‚ç®€å•æ¥è¯´ï¼ŒSpring4.0 åŸºäº Java6ï¼Œå…¨é¢æ”¯æŒ Java8ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨ Java8ã€‚

**Spring4 å¸¦æ¥çš„å¥½å¤„ï¼š**

> Java8 æ–°ç‰¹æ€§

1. Lambda è¡¨è¾¾å¼
2. Java8 çš„æ—¥æœŸå’Œæ—¶é—´ API
3. é‡å¤æ³¨è§£æ”¯æŒï¼ˆç›®å‰æ”¯æŒ@Scheduledã€@PropertySourceï¼‰
4. Optianl

> æ ¸å¿ƒå®¹å™¨å¢å¼º

1. èŒƒå‹ä¾èµ–æ³¨å…¥
2. Map ä¾èµ–æ³¨å…¥
3. @Lazy å»¶è¿Ÿä¾èµ–æ³¨å…¥
4. List æ³¨å…¥
5. @Conditional æ³¨è§£
6. Cglib ä»£ç†å¢å¼º

> å…¶ä»–

1. æ”¯æŒ Groovy å®šä¹‰ Bean
2. Servlet å¢å¼ºï¼ŒåŸºäº Servlet3.1
3. æ”¯æŒ WebSocket
4. æµ‹è¯•å¢å¼º
5. JSR-107 æ³¨è§£æ”¯æŒï¼ŒJCache
6. åŠ¨æ€è¯­è¨€æ”¯æŒ
7. å¤šçº¿ç¨‹å¹¶å‘æ”¯æŒï¼ˆå¯¹ JDK çš„ Future è¿›è¡Œäº†å°è£…ï¼‰
8. æŒä¹…åŒ–å¢å¼ºå¤„ç†

### Spring çš„å­é¡¹ç›®

> Spring çš„å­é¡¹ç›®ä¼—å¤šï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å» https://spring.io/projects æŸ¥çœ‹ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªæˆªå›¾ï¼ˆå›¾ç‰‡æ¥è‡ªã€Šç²¾é€š Spring4.x ä¼ä¸šåº”ç”¨å¼€å‘å®æˆ˜ã€‹ï¼‰ï¼š

![spring_son_01](../../../images/spring/spring_son_01.png)
![spring_son_01](../../../images/spring/spring_son_02.png)

### Spring çš„å­¦ä¹ 

è·å– Spring æ¨èä»å®˜ç½‘ä¸‹è½½ï¼Œè¿™é‡Œæ¨èå‚è€ƒ Spring å®˜æ–¹çš„æ–‡æ¡£å¹¶`clone`æºç åŠ`example`æ¥å­¦ä¹ ã€‚

**ç‰¹åˆ«æé†’ï¼šå»ºè®®å¤§å®¶è¿˜æ˜¯`fork`é¡¹ç›®åˆ°è‡ªå·±çš„ä»“åº“ï¼Œä»¥æ–¹ä¾¿è‡ªå·±å¯ä»¥ä»»æ„çš„æäº¤å¹¶ä¿®æ”¹ã€‚**

| åç§°     | é™åˆ¶               |
| -------- | ------------------ |
| å­¦ä¹ å·¥å…· | IDEAã€Eclipseã€STS |
| JDKç‰ˆæœ¬  | 1.8+               |
| ç³»ç»Ÿç‰ˆæœ¬ | Windows/MacOS      |
| Maven    | 3.x+               |

**ä¸‹è½½ Spring é¡¹ç›®ï¼š**

> è¿™é‡Œæä¸€ä¸‹ Spring5.X æ–°ç‰¹æ€§å‚è€ƒï¼š[Spring5.X æ–°ç‰¹æ€§](https://www.jianshu.com/p/cebc3cf0bec0)ã€‚å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©æƒ³è¦å­¦ä¹ çš„ç‰ˆæœ¬ã€‚å½“ç„¶ï¼Œæœ¬ç³»åˆ—åç»­æ–‡ç« ä¸»è¦ä»¥`Spring4.x`ä»¥åŠ`Spring5.x`ä¸ºä¸»ï¼Œå› ä¸ºç›®å‰è€Œè¨€4.xå’Œ5.xç”¨çš„åº”è¯¥æ˜¯æœ€å¹¿æ³›çš„ã€‚

```
// 4.3.xç‰ˆæœ¬
git clone -b 4.3.x https://github.com/spring-projects/spring-framework.git

// 5.0.xç‰ˆæœ¬
git clone -b 5.0.x https://github.com/spring-projects/spring-framework.git
```

å¦‚æœä½ æ²¡æœ‰å®‰è£…`git`æˆ–è€…ä¸ä¼šä½¿ç”¨`git`ï¼Œè¯·å‚è€ƒ `Development/git`ç›¸å…³ç³»åˆ—æ–‡ç« æˆ–`baidu`ã€`google`ã€‚

**ä¸‹è½½ Spring å®ä¾‹é¡¹ç›®ï¼š**

> æˆ‘ä»¬å­¦ä¹  Spring æºç è‡ªç„¶æ˜¯ç¦»ä¸å¼€å®˜ç½‘æä¾›çš„ä¸€äº›å®ä¾‹ä»£ç çš„æ”¯æŒçš„ï¼Œè¿™æ ·å¯ä»¥åŠ é€Ÿæˆ‘ä»¬çš„å­¦ä¹ ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç†è§£ã€‚

```
// master
git clone https://github.com/spring-projects/spring-petclinic.git
git checkout 1.5.x

// ä½¿ç”¨æ–¹å¼
cd spring-petclinic
./mvnw package
java -jar target/*.jar
```

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ï¼š http://localhost:8080/ å³å¯å¿«ä¹è¿›è¡Œå­¦ä¹ ã€‚
